# User-balance
## Запуск
Скопируйте проект
```
git clone https://github.com/RomanMRR/User-balance.git`
```
Перейдите в папку проекта
```
cd User-balance/
```
Запустите проект
```
docker-compose up --build
```

## Создание нового пользователя

### Запрос

Для создания нового пользователя необходимо выполнить следующий запрос
```
POST localhost:8000/auth/sign-up
```

Передаются следующие параметры
Имя | Тип | Обязательный | Описание
--- | --- |------------ | ---
name | строка | да | имя пользователя
username | строка | да | никнейм  
password | строка | да | пароль пользователя

Пример запроса:
```javascript
{
    "name": "Maksim",
    "username": "Maksimka",
    "password": "qwerty"
}
```
### Ответ
Успешный ответ приходит с кодом `200 ОК` и содержит:
```javascript
{
    "id": 1
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 id | число | Уникальный идентификатор пользователя в базе данных


## Получение баланса пользователя

### Запрос
```
GET localhost:8000/api/balance/
```

Передаются следующие параметры
Имя | Тип | Обязательный | Описание
--- | --- |------------ | ---
user_id | число | да | уникальный идентификатор пользователя

Пример запроса:
```javascript
{
    "user_id": 1
}
```
### Ответ
Успешный ответ приходит с кодом `200 ОК` и содержит:
```javascript
{
    "balance": 20.2,
    "user_id": 1
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 balance | число | Количество средств на основном счёте пользователя
 user_id | число | уникальный идентификатор пользователя

## Зачисление средств на счёт

### Запрос
```
PUT localhost:8000/api/balance/
```

Передаются следующие параметры
Имя | Тип | Обязательный | Описание
--- | --- |------------ | ---
user_id | число | да | уникальный идентификатор пользователя
amount | число | да | количество средств, необходимых к зачислению

Пример запроса:
```javascript
{
    "user_id": 1,
    "amount": 20.2
}
```
### Ответ
Успешный ответ приходит с кодом `200 ОК` и содержит:
```javascript
{
    "status": "ok"
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 status | строка | Статус успешности проведения операции

## Резервирование средств

### Запрос
```
PUT localhost:8000/api/balance/reserve
```

Передаются следующие параметры
Имя | Тип | Обязательный | Описание
--- | --- |------------ | ---
user_id | число | да | уникальный идентификатор пользователя
amount | число | да | количество средств, необходимых к резервированию
service_id | число | да | уникальный идентификатор услуги
order_id | число | да | уникальный идентификатор заказа


Пример запроса:
```javascript
{
    "user_id" : 1,
    "amount" : 10.2,
    "service_id" : 1,
    "order_id" : 1
}
```
### Ответ
Успешный ответ приходит с кодом `200 ОК` и содержит:
```javascript
{
    "status": "ok"
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 status | строка | Статус успешности проведения операции

 Если на счёте недостаточно средств, то ответ приходит с кодом `400 Bad Request` и содержит
 ```javascript
{
    "message": "Insufficient funds"
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 message | строка | Причина ошибки

 ## Списание средств из резерва

### Запрос
```
PUT localhost:8000/api/balance/withdraw
```

Передаются следующие параметры
Имя | Тип | Обязательный | Описание
--- | --- |------------ | ---
user_id | число | да | уникальный идентификатор пользователя
amount | число | да | количество средств, необходимых к резервированию
service_id | число | да | уникальный идентификатор услуги
order_id | число | да | уникальный идентификатор заказа


Пример запроса:
```javascript
{
    "user_id" : 1,
    "amount" : 10.2,
    "service_id" : 1,
    "order_id" : 1
}
```
### Ответ
Успешный ответ приходит с кодом `200 ОК` и содержит:
```javascript
{
    "status": "ok"
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 status | строка | Статус успешности проведения операции

 Если на счёте недостаточно средств, то ответ приходит с кодом `400 Bad Request` и содержит
 ```javascript
{
    "message": "insufficient funds in the reserve account"
}
```
где:
Имя | Тип | Описание
 --- | --- | ---
 message | строка | Причина ошибки


